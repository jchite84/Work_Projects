library(reshape2)
prospects <- read.csv("L:/Advancement/Justin/Call Officers/Kraig R. Smith - Dir. Alumni Relations/2015 July 10 Cranberry States.csv")
giving <- read.csv("L:/Advancement/Justin/Call Officers/Justin Reports/2015 June 29 FY2014 2015 Giving.csv")
employees <- read.csv("L:/Advancement/Justin/Call Officers/Justin Reports/Employees.csv")
zips <- read.csv("L:/Advancement/Justin/Call Officers/Kraig R. Smith - Dir. Alumni Relations/2015 July 10 Cranberry Zips.csv")
giving <- giving[,c(1, 21, 22)]
giving$PEOPLE_ID <- giving[,1]
giving <- giving [,c(4,2,3)]
giving$TotalGivingAmount <- substring(giving$TotalGivingAmount, 2)
giving$PledgeBalanceSum <- substring(giving$PledgeBalanceSum, 2)
giving$TotalGivingAmount <- as.integer(giving$TotalGivingAmount)
giving$PledgeBalanceSum <- as.integer(giving$PledgeBalanceSum)
prospects <- merge(prospects, giving, by = c("PEOPLE_ID", "PEOPLE_ID"), all = TRUE)
prospects$ZIP_CODE <- substring(prospects$ZIP_CODE, 1, 5)
prospects$ZIP_CODE <- as.integer(prospects$ZIP_CODE)
zipsInRadius <- prospects$ZIP_CODE %in% zips$Zips
prospects <- cbind(prospects, zipsInRadius)
prospects <- subset(prospects, zipsInRadius == "TRUE")
rm(zipsInRadius)
is.employee <- prospects$PEOPLE_ID %in% employees$PEOPLE_CODE_ID
prospects <- cbind(prospects, is.employee)
employees.invite <- subset(prospects, is.employee == "TRUE")
rm(is.employee)
alum <- subset(prospects, is.employee == "FALSE" & PEOPLE_TYPE == "ALUM"| PEOPLE_TYPE == "ALNG")
#Friends into separate dataframe
friends <- subset(prospects, is.employee == "FALSE" & PEOPLE_TYPE == "FRND" | PEOPLE_TYPE == "HONR")
assignedfriends <- subset(friends, ï..SOLICITOR_CODE != "")
#friends with giving or pledges
invitefriends <- subset(friends, (ï..SOLICITOR_CODE == "" & TotalGivingAmount >= 100) | (ï..SOLICITOR_CODE == "" & !(is.na(PledgeBalanceSum))))
filteredlist <- rbind(alum, assignedfriends, invitefriends)
rm(alum, assignedfriends,invitefriends, friends, giving)
filteredlist <- subset(filteredlist, NO_MAIL != "DNC from Conversion" & NO_MAIL != "One Time Gift" & CallRules != "DNC from Conversion" & CallRules != "Deceased")
filteredlist <- filteredlist[,c(1, 85, 14, 15, 16, 17, 18, 19, 60, 61, 62)]
ICM <- employees.invite[,c(1, 85, 14, 15, 16, 17, 18, 19, 60, 61, 62)]
duplicates <- duplicated(filteredlist[,2])
filteredlist <- cbind(filteredlist, duplicates)
employee.duplicates <- duplicated(ICM[,2])
ICM <- cbind(ICM, employee.duplicates)
filteredlist <- subset(filteredlist, duplicates == "FALSE")
filteredlist <- filteredlist[,c(1:11)]
ICM <- subset(ICM, employee.duplicates == "FALSE")
ICM <- ICM[,c(1:11)]
rm(duplicates, employee.duplicates, employees, employees.invite)
write.csv(filteredlist, "L:/Advancement/Justin/Call Officers/Kraig R. Smith - Dir. Alumni Relations/2015 July 10 Cranberry Mailer.csv.csv")
write.csv(ICM, "L:/Advancement/Justin/Call Officers/Kraig R. Smith - Dir. Alumni Relations/2015 July 10 Cranberry Employees Mailer.csv")
library(reshape2)
library(lubridate)
DN <- read.csv("L:/Advancement/Justin/Call Officers/All Directors/Director's Numbers for R Script.csv")
Range.Actions.Orgs <- read.csv("L:/Advancement/Justin/Call Officers/All Directors/2015 July 2 All Actions for FY Orgs_1.csv", header = TRUE)
Range.Actions.Ind <- read.csv("L:/Advancement/Justin/Call Officers/All Directors/2015 July 13 All Actions FY 2015.csv")
colnames(Range.Actions.Orgs)<- c("SOLICITOR_CODE", "PEOPLE_CODE_ID", "FIRST_NAME", "MIDDLE_NAME", "LAST_NAME",
"STATE", "ACTION_ID", "SCHEDULED_DATE", "EXECUTION_DATE", "COMPLETED_BY", "NOTE")
Range.Actions <- rbind(Range.Actions.Ind, Range.Actions.Orgs)
Range.Actions <- merge(Range.Actions, DN)
Range.Actions$EXECUTION_DATE <- substring(Range.Actions$EXECUTION_DATE, 1, 14)
Range.Actions.Date <- strptime(x = as.character(Range.Actions$EXECUTION_DATE), format = "%m/%d/%Y %H:%M")
Range.Actions <- cbind(Range.Actions, paste(month(Range.Actions.Date), "/", year(Range.Actions.Date)))
colnames(Range.Actions)[14] <- "MONTH_YEAR"
rm(Range.Actions.Date)
Range.Actions <- subset(Range.Actions, ACTION_ID == "CAFC2FC")
Range.Summary <- dcast(Range.Actions, TITLE~MONTH_YEAR, value.var = "ACTION_ID", length, margins = TRUE)
Range.Summary <- Range.Summary[,c(1, 11:13, 3:5, 2, 6:10, 14)]
View(Range.Summary)
View(Range.Summary)
write.csv(Range.Summary, file = "L:/Advancement/Justin/Call Officers/All Directors/2015 July 13 Visis Only FY Summary.csv")
write.csv(Range.Actions, file = "L:/Advancement/Justin/Call Officers/All Directors/2015 July 13 Visits Only FY Detail.csv")
